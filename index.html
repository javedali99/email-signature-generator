<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional Email Signature Generator</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- FontAwesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Lato:wght@300;400;700&family=Montserrat:wght@300;400;500;600;700&family=Open+Sans:wght@300;400;600;700&family=Plus+Jakarta+Sans:wght@300;400;500;600;700&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['"Plus Jakarta Sans"', 'sans-serif'],
                    },
                    colors: {
                        brand: {
                            50: '#eff6ff',
                            100: '#dbeafe',
                            500: '#3b82f6',
                            600: '#2563eb',
                            700: '#1d4ed8',
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #f8fafc;
        }
        
        /* Custom Scrollbar */
        .custom-scroll::-webkit-scrollbar {
            width: 6px;
        }
        .custom-scroll::-webkit-scrollbar-track {
            background: transparent;
        }
        .custom-scroll::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 10px;
        }
        .custom-scroll::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        /* Tabs Animation */
        .tab-content {
            display: none;
            animation: fadeIn 0.4s cubic-bezier(0.16, 1, 0.3, 1);
        }
        .tab-content.active {
            display: block;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Color Input Reset */
        input[type="color"] {
            -webkit-appearance: none;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 12px;
            padding: 0;
            overflow: hidden;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        input[type="color"]::-webkit-color-swatch-wrapper {
            padding: 0;
        }
        input[type="color"]::-webkit-color-swatch {
            border: none;
            border-radius: 12px;
            border: 1px solid rgba(0,0,0,0.1);
        }

        /* Preview Pattern */
        .preview-bg {
            background-color: #f1f5f9;
            background-image: 
                linear-gradient(45deg, #e2e8f0 25%, transparent 25%), 
                linear-gradient(-45deg, #e2e8f0 25%, transparent 25%), 
                linear-gradient(45deg, transparent 75%, #e2e8f0 75%), 
                linear-gradient(-45deg, transparent 75%, #e2e8f0 75%);
            background-size: 20px 20px;
            background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
        }
    </style>
</head>
<body class="h-screen flex flex-col md:flex-row overflow-hidden text-slate-800 antialiased">

    <!-- LEFT SIDEBAR: Controls -->
    <div class="w-full md:w-[480px] bg-white flex flex-col shadow-2xl z-20 border-r border-slate-200 h-full relative">
        
        <!-- Header -->
        <div class="px-6 py-5 border-b border-slate-100 flex items-center justify-between bg-white/80 backdrop-blur-md sticky top-0 z-10">
            <div class="flex items-center gap-3">
                <!-- NEW CUSTOM LOGO -->
                <div class="w-10 h-10 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-xl flex items-center justify-center text-white shadow-lg shadow-blue-500/30 transform hover:scale-105 transition-transform duration-300">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M15.5 3.5L20.5 8.5L10.5 18.5H5.5V13.5L15.5 3.5Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M13.5 5.5L18.5 10.5" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M3 21.5C3 21.5 6 18.5 11 20.5" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <div>
                    <h1 class="text-lg font-bold tracking-tight text-slate-900 leading-tight">SigGen</h1>
                    <p class="text-[10px] font-semibold text-slate-400 uppercase tracking-wider">Signature Creator</p>
                </div>
            </div>
            <a href="#" class="text-xs font-medium px-3 py-1.5 bg-slate-100 text-slate-600 rounded-lg hover:bg-slate-200 transition-colors">
                <i class="fa-brands fa-github mr-1"></i> v2.3
            </a>
        </div>

        <!-- Navigation Tabs -->
        <div class="px-6 pt-4 pb-2 bg-white">
            <div class="flex p-1 bg-slate-100 rounded-xl">
                <button onclick="switchTab('details')" id="tab-btn-details" class="flex-1 py-2.5 text-sm font-semibold rounded-lg shadow-sm bg-white text-slate-800 transition-all duration-200 flex items-center justify-center gap-2">
                    <i class="fa-regular fa-id-card"></i> Details
                </button>
                <button onclick="switchTab('social')" id="tab-btn-social" class="flex-1 py-2.5 text-sm font-medium rounded-lg text-slate-500 hover:text-slate-700 transition-all duration-200 flex items-center justify-center gap-2">
                    <i class="fa-solid fa-share-nodes"></i> Social
                </button>
                <button onclick="switchTab('design')" id="tab-btn-design" class="flex-1 py-2.5 text-sm font-medium rounded-lg text-slate-500 hover:text-slate-700 transition-all duration-200 flex items-center justify-center gap-2">
                    <i class="fa-solid fa-swatchbook"></i> Design
                </button>
            </div>
        </div>

        <!-- Scrollable Content -->
        <div class="flex-1 overflow-y-auto custom-scroll p-6 space-y-8">
            
            <!-- DETAILS TAB -->
            <div id="tab-details" class="tab-content active space-y-6">
                <!-- Personal Group -->
                <div class="space-y-4">
                    <div class="flex items-center gap-2 text-xs font-bold text-slate-400 uppercase tracking-wider">
                        <i class="fa-regular fa-user"></i> Personal Info
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="space-y-1.5">
                            <label class="text-xs font-semibold text-slate-600">First Name</label>
                            <input type="text" id="firstName" value="Sarah" class="w-full px-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl focus:bg-white focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all text-sm font-medium placeholder:text-slate-400" placeholder="e.g. Jane">
                        </div>
                        <div class="space-y-1.5">
                            <label class="text-xs font-semibold text-slate-600">Last Name</label>
                            <input type="text" id="lastName" value="Connor" class="w-full px-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl focus:bg-white focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all text-sm font-medium placeholder:text-slate-400" placeholder="e.g. Doe">
                        </div>
                        <div class="col-span-2 space-y-1.5">
                            <label class="text-xs font-semibold text-slate-600">Job Title</label>
                            <input type="text" id="jobTitle" value="Product Design Lead" class="w-full px-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl focus:bg-white focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all text-sm font-medium placeholder:text-slate-400">
                        </div>
                        <div class="col-span-2 space-y-1.5">
                            <label class="text-xs font-semibold text-slate-600">Department</label>
                            <input type="text" id="department" value="Creative & Marketing" class="w-full px-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl focus:bg-white focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all text-sm font-medium placeholder:text-slate-400">
                        </div>
                    </div>
                </div>

                <div class="h-px bg-slate-100"></div>

                <!-- Company Group -->
                <div class="space-y-4">
                    <div class="flex items-center gap-2 text-xs font-bold text-slate-400 uppercase tracking-wider">
                        <i class="fa-regular fa-building"></i> Company Info
                    </div>
                    <div class="space-y-4">
                        <div class="space-y-1.5">
                            <label class="text-xs font-semibold text-slate-600">Company Name</label>
                            <input type="text" id="companyName" value="Acme Studio Inc." class="w-full px-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl focus:bg-white focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all text-sm font-medium">
                        </div>
                        <div class="space-y-1.5">
                            <label class="text-xs font-semibold text-slate-600">Website URL</label>
                            <div class="relative">
                                <i class="fa-solid fa-link absolute left-4 top-3 text-slate-400 text-xs"></i>
                                <input type="text" id="website" value="www.acmestudio.com" class="w-full pl-10 pr-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl focus:bg-white focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all text-sm font-medium">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="h-px bg-slate-100"></div>

                <!-- Contact Group -->
                <div class="space-y-4">
                    <div class="flex items-center gap-2 text-xs font-bold text-slate-400 uppercase tracking-wider">
                        <i class="fa-regular fa-address-book"></i> Contact Details
                    </div>
                    <div class="space-y-4">
                        <div class="grid grid-cols-2 gap-4">
                            <div class="space-y-1.5">
                                <label class="text-xs font-semibold text-slate-600">Mobile</label>
                                <input type="text" id="mobilePhone" value="+1 (555) 123-4567" class="w-full px-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl focus:bg-white focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all text-sm font-medium">
                            </div>
                            <div class="space-y-1.5">
                                <label class="text-xs font-semibold text-slate-600">Office</label>
                                <input type="text" id="officePhone" value="+1 (555) 987-6543" class="w-full px-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl focus:bg-white focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all text-sm font-medium">
                            </div>
                        </div>
                        <div class="space-y-1.5">
                            <label class="text-xs font-semibold text-slate-600">Email Address</label>
                            <input type="email" id="email" value="sarah.c@acmestudio.com" class="w-full px-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl focus:bg-white focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all text-sm font-medium">
                        </div>
                        <div class="space-y-1.5">
                            <label class="text-xs font-semibold text-slate-600">Physical Address</label>
                            <input type="text" id="address" value="123 Design Avenue, San Francisco, CA" class="w-full px-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl focus:bg-white focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all text-sm font-medium">
                        </div>
                    </div>
                </div>
            </div>

            <!-- SOCIAL TAB -->
            <div id="tab-social" class="tab-content space-y-6">
                <!-- ... existing social content ... -->
                <div class="bg-blue-50 border border-blue-100 rounded-xl p-4 text-sm text-blue-800 flex items-start gap-3">
                    <i class="fa-solid fa-circle-info mt-1 text-blue-500"></i>
                    <p>Enter the full URL for your social profiles. Leave empty to hide the icon.</p>
                </div>

                <div class="space-y-4">
                    <!-- LinkedIn -->
                    <div class="group relative">
                        <div class="absolute left-4 top-3 w-5 flex justify-center text-slate-400 transition-colors group-focus-within:text-blue-600">
                            <i class="fab fa-linkedin-in text-lg"></i>
                        </div>
                        <input type="text" id="linkedin" value="linkedin.com/in/username" placeholder="LinkedIn URL" class="w-full pl-12 pr-4 py-3 bg-white border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all text-sm shadow-sm">
                    </div>

                    <!-- X / Twitter -->
                    <div class="group relative">
                        <div class="absolute left-4 top-3 w-5 flex justify-center text-slate-400 transition-colors group-focus-within:text-black">
                             <svg viewBox="0 0 24 24" aria-hidden="true" class="w-4 h-4 fill-current"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"></path></svg>
                        </div>
                        <input type="text" id="twitter" value="x.com/username" placeholder="X (Twitter) URL" class="w-full pl-12 pr-4 py-3 bg-white border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all text-sm shadow-sm">
                    </div>

                    <!-- Instagram -->
                    <div class="group relative">
                        <div class="absolute left-4 top-3 w-5 flex justify-center text-slate-400 transition-colors group-focus-within:text-pink-600">
                            <i class="fab fa-instagram text-lg"></i>
                        </div>
                        <input type="text" id="instagram" placeholder="Instagram URL" class="w-full pl-12 pr-4 py-3 bg-white border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all text-sm shadow-sm">
                    </div>

                    <!-- Facebook -->
                    <div class="group relative">
                        <div class="absolute left-4 top-3 w-5 flex justify-center text-slate-400 transition-colors group-focus-within:text-blue-700">
                            <i class="fab fa-facebook-f text-lg"></i>
                        </div>
                        <input type="text" id="facebook" placeholder="Facebook URL" class="w-full pl-12 pr-4 py-3 bg-white border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all text-sm shadow-sm">
                    </div>
                    
                    <!-- WhatsApp -->
                    <div class="group relative">
                         <div class="absolute left-4 top-3 w-5 flex justify-center text-slate-400 transition-colors group-focus-within:text-green-500">
                            <i class="fab fa-whatsapp text-lg"></i>
                        </div>
                        <input type="text" id="whatsapp" placeholder="WhatsApp Number/Link" class="w-full pl-12 pr-4 py-3 bg-white border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all text-sm shadow-sm">
                    </div>

                    <!-- YouTube -->
                    <div class="group relative">
                        <div class="absolute left-4 top-3 w-5 flex justify-center text-slate-400 transition-colors group-focus-within:text-red-600">
                            <i class="fab fa-youtube text-lg"></i>
                        </div>
                        <input type="text" id="youtube" placeholder="YouTube URL" class="w-full pl-12 pr-4 py-3 bg-white border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all text-sm shadow-sm">
                    </div>
                    
                    <!-- TikTok -->
                    <div class="group relative">
                        <div class="absolute left-4 top-3 w-5 flex justify-center text-slate-400 transition-colors group-focus-within:text-black">
                            <i class="fab fa-tiktok text-lg"></i>
                        </div>
                        <input type="text" id="tiktok" placeholder="TikTok URL" class="w-full pl-12 pr-4 py-3 bg-white border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all text-sm shadow-sm">
                    </div>

                    <!-- BlueSky -->
                    <div class="group relative">
                        <div class="absolute left-4 top-3 w-5 flex justify-center text-slate-400 transition-colors group-focus-within:text-sky-500">
                            <i class="fa-solid fa-cloud text-lg"></i>
                        </div>
                        <input type="text" id="bluesky" placeholder="BlueSky URL" class="w-full pl-12 pr-4 py-3 bg-white border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all text-sm shadow-sm">
                    </div>

                    <!-- GitHub -->
                    <div class="group relative">
                        <div class="absolute left-4 top-3 w-5 flex justify-center text-slate-400 transition-colors group-focus-within:text-slate-800">
                            <i class="fab fa-github text-lg"></i>
                        </div>
                        <input type="text" id="github" placeholder="GitHub URL" class="w-full pl-12 pr-4 py-3 bg-white border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all text-sm shadow-sm">
                    </div>

                    <!-- Scholar -->
                    <div class="group relative">
                        <div class="absolute left-4 top-3 w-5 flex justify-center text-slate-400 transition-colors group-focus-within:text-blue-500">
                            <i class="fa-solid fa-graduation-cap text-lg"></i>
                        </div>
                        <input type="text" id="scholar" placeholder="Google Scholar URL" class="w-full pl-12 pr-4 py-3 bg-white border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all text-sm shadow-sm">
                    </div>
                </div>
            </div>

            <!-- DESIGN TAB -->
            <div id="tab-design" class="tab-content space-y-8">
                
                <!-- Images Section -->
                <div class="space-y-4">
                    <div class="flex items-center gap-2 text-xs font-bold text-slate-400 uppercase tracking-wider">
                        <i class="fa-regular fa-image"></i> Profile & Logo
                    </div>
                    
                    <div class="bg-white p-4 rounded-xl border border-slate-200 shadow-sm space-y-4">
                        <div>
                            <label class="text-xs font-semibold text-slate-600 block mb-2">Profile Picture</label>
                            <div class="flex gap-3 items-center">
                                <label class="cursor-pointer bg-slate-50 hover:bg-slate-100 text-slate-700 text-xs font-bold py-2.5 px-4 rounded-lg inline-flex items-center transition-all border border-slate-200 shadow-sm active:scale-95">
                                    <i class="fa-solid fa-cloud-arrow-up mr-2 text-blue-500"></i>
                                    <span>Upload Photo</span>
                                    <input type="file" id="photoUpload" class="hidden" accept="image/*" onchange="handleImageUpload(this)">
                                </label>
                                <span class="text-[10px] text-slate-400 uppercase font-semibold">OR</span>
                                <input type="text" id="photoUrl" class="flex-1 px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-xs outline-none focus:border-blue-500 transition-all placeholder:text-slate-400" placeholder="Paste Image URL..." value="https://images.unsplash.com/photo-1494790108377-be9c29b29330?ixlib=rb-1.2.1&auto=format&fit=crop&w=256&q=80">
                            </div>
                            
                            <!-- Image Shape Selector -->
                             <div class="flex gap-2 mt-4">
                                <button onclick="setImageShape('circle')" class="shape-btn active flex-1 py-2 border border-slate-200 rounded-lg text-xs font-semibold text-slate-600 hover:bg-slate-50 transition-all flex items-center justify-center gap-2" data-shape="circle">
                                    <div class="w-4 h-4 rounded-full bg-slate-300"></div>
                                    <span>Circle</span>
                                </button>
                                <button onclick="setImageShape('square')" class="shape-btn flex-1 py-2 border border-slate-200 rounded-lg text-xs font-semibold text-slate-600 hover:bg-slate-50 transition-all flex items-center justify-center gap-2" data-shape="square">
                                    <div class="w-4 h-4 rounded-sm bg-slate-300"></div>
                                    <span>Square</span>
                                </button>
                            </div>
                        </div>

                        <div class="h-px bg-slate-100"></div>

                        <div>
                            <label class="text-xs font-semibold text-slate-600 block mb-2">Company Logo (Optional)</label>
                            <input type="text" id="logoUrl" class="w-full px-3 py-2.5 bg-slate-50 border border-slate-200 rounded-lg text-sm outline-none focus:border-blue-500 transition-all" placeholder="https://...">
                        </div>

                        <div class="h-px bg-slate-100"></div>

                        <!-- Image Size Slider -->
                        <div>
                            <div class="flex justify-between items-center mb-2">
                                <label class="text-xs font-semibold text-slate-600">Image Size</label>
                                <span id="imageSizeLabel" class="text-[10px] font-mono text-slate-400">100px</span>
                            </div>
                            <input type="range" id="imageSize" min="50" max="200" value="100" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-blue-600">
                        </div>
                    </div>
                </div>

                <!-- Theme Color -->
                <div class="space-y-4">
                    <div class="flex items-center justify-between">
                         <div class="flex items-center gap-2 text-xs font-bold text-slate-400 uppercase tracking-wider">
                            <i class="fa-solid fa-droplet"></i> Accent Color
                        </div>
                        <span id="colorValue" class="text-xs font-mono bg-slate-100 px-2 py-1 rounded text-slate-500">#2563EB</span>
                    </div>

                    <div class="bg-white p-4 rounded-xl border border-slate-200 shadow-sm flex items-center gap-4">
                        <input type="color" id="themeColor" value="#2563EB" class="shrink-0">
                        <div class="flex flex-1 justify-between gap-2">
                            <button class="w-8 h-8 rounded-full bg-blue-600 hover:scale-110 transition-transform shadow-sm" onclick="setThemeColor('#2563EB')"></button>
                            <button class="w-8 h-8 rounded-full bg-emerald-600 hover:scale-110 transition-transform shadow-sm" onclick="setThemeColor('#059669')"></button>
                            <button class="w-8 h-8 rounded-full bg-rose-600 hover:scale-110 transition-transform shadow-sm" onclick="setThemeColor('#e11d48')"></button>
                            <button class="w-8 h-8 rounded-full bg-violet-600 hover:scale-110 transition-transform shadow-sm" onclick="setThemeColor('#7c3aed')"></button>
                            <button class="w-8 h-8 rounded-full bg-slate-900 hover:scale-110 transition-transform shadow-sm" onclick="setThemeColor('#0f172a')"></button>
                        </div>
                    </div>
                </div>

                <!-- Typography -->
                <div class="space-y-4">
                    <div class="flex items-center gap-2 text-xs font-bold text-slate-400 uppercase tracking-wider">
                        <i class="fa-solid fa-font"></i> Typography
                    </div>
                    <div class="relative">
                        <i class="fa-solid fa-chevron-down absolute right-4 top-3.5 text-slate-400 text-xs pointer-events-none"></i>
                        <select id="fontSelect" onchange="setFont(this.value)" class="w-full appearance-none px-4 py-3 bg-white border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all text-sm font-medium shadow-sm cursor-pointer text-slate-700">
                            <!-- Options populated by JS -->
                        </select>
                    </div>
                </div>

                <!-- Layout Templates -->
                <div class="space-y-4">
                    <div class="flex items-center gap-2 text-xs font-bold text-slate-400 uppercase tracking-wider">
                        <i class="fa-solid fa-layer-group"></i> Choose Layout
                    </div>
                    <div class="grid grid-cols-2 gap-3">
                        <!-- Classic -->
                        <button onclick="setTemplate('classic')" class="template-btn group relative p-4 border-2 rounded-xl text-left hover:border-blue-500 transition-all bg-white shadow-sm" data-template="classic">
                            <div class="w-full h-12 bg-slate-50 rounded mb-3 border border-slate-100 overflow-hidden flex items-center p-2 gap-2 opacity-60 group-hover:opacity-100 transition-opacity">
                                <div class="w-8 h-8 rounded-full bg-slate-300"></div>
                                <div class="flex-1 space-y-1">
                                    <div class="h-1.5 w-12 bg-slate-300 rounded"></div>
                                    <div class="h-1.5 w-8 bg-slate-200 rounded"></div>
                                </div>
                            </div>
                            <span class="block text-sm font-bold text-slate-700 group-hover:text-blue-600">Classic</span>
                            <span class="text-[10px] text-slate-400">Horizontal with border</span>
                            <div class="absolute top-3 right-3 opacity-0 group-[.active]:opacity-100 text-blue-600">
                                <i class="fa-solid fa-circle-check"></i>
                            </div>
                        </button>

                        <!-- Compact -->
                        <button onclick="setTemplate('compact')" class="template-btn group relative p-4 border-2 rounded-xl text-left hover:border-blue-500 transition-all bg-white shadow-sm" data-template="compact">
                             <div class="w-full h-12 bg-slate-50 rounded mb-3 border border-slate-100 overflow-hidden flex items-center p-2 gap-2 opacity-60 group-hover:opacity-100 transition-opacity">
                                <div class="w-6 h-6 rounded bg-slate-300"></div>
                                <div class="flex-1 space-y-1">
                                    <div class="h-1.5 w-full bg-slate-300 rounded"></div>
                                    <div class="h-1.5 w-1/2 bg-slate-200 rounded"></div>
                                </div>
                            </div>
                            <span class="block text-sm font-bold text-slate-700 group-hover:text-blue-600">Compact</span>
                            <span class="text-[10px] text-slate-400">Minimalist & clean</span>
                             <div class="absolute top-3 right-3 opacity-0 group-[.active]:opacity-100 text-blue-600">
                                <i class="fa-solid fa-circle-check"></i>
                            </div>
                        </button>

                        <!-- Stacked -->
                        <button onclick="setTemplate('stacked')" class="template-btn group relative p-4 border-2 rounded-xl text-left hover:border-blue-500 transition-all bg-white shadow-sm" data-template="stacked">
                            <div class="w-full h-12 bg-slate-50 rounded mb-3 border border-slate-100 overflow-hidden flex flex-col items-center justify-center gap-1 opacity-60 group-hover:opacity-100 transition-opacity">
                                <div class="w-4 h-4 rounded-full bg-slate-300"></div>
                                <div class="h-1 w-12 bg-slate-300 rounded"></div>
                                <div class="h-1 w-8 bg-slate-200 rounded"></div>
                            </div>
                            <span class="block text-sm font-bold text-slate-700 group-hover:text-blue-600">Stacked</span>
                            <span class="text-[10px] text-slate-400">Centered layout</span>
                             <div class="absolute top-3 right-3 opacity-0 group-[.active]:opacity-100 text-blue-600">
                                <i class="fa-solid fa-circle-check"></i>
                            </div>
                        </button>

                        <!-- Banner -->
                        <button onclick="setTemplate('banner')" class="template-btn group relative p-4 border-2 rounded-xl text-left hover:border-blue-500 transition-all bg-white shadow-sm" data-template="banner">
                            <div class="w-full h-12 bg-slate-50 rounded mb-3 border border-slate-100 overflow-hidden flex flex-col justify-between opacity-60 group-hover:opacity-100 transition-opacity">
                                <div class="p-2 space-y-1">
                                    <div class="h-1 w-10 bg-slate-300 rounded"></div>
                                </div>
                                <div class="h-3 w-full bg-slate-300"></div>
                            </div>
                            <span class="block text-sm font-bold text-slate-700 group-hover:text-blue-600">Banner</span>
                            <span class="text-[10px] text-slate-400">With colored footer</span>
                             <div class="absolute top-3 right-3 opacity-0 group-[.active]:opacity-100 text-blue-600">
                                <i class="fa-solid fa-circle-check"></i>
                            </div>
                        </button>

                         <!-- Sidebar (NEW) -->
                        <button onclick="setTemplate('sidebar')" class="template-btn group relative p-4 border-2 rounded-xl text-left hover:border-blue-500 transition-all bg-white shadow-sm" data-template="sidebar">
                            <div class="w-full h-12 bg-slate-50 rounded mb-3 border border-slate-100 overflow-hidden flex opacity-60 group-hover:opacity-100 transition-opacity">
                                <div class="w-1/3 h-full bg-slate-300 flex items-center justify-center">
                                     <div class="w-3 h-3 rounded-full bg-slate-400 border border-white"></div>
                                </div>
                                <div class="flex-1 p-2 space-y-1">
                                    <div class="h-1 w-full bg-slate-200 rounded"></div>
                                    <div class="h-1 w-2/3 bg-slate-200 rounded"></div>
                                </div>
                            </div>
                            <span class="block text-sm font-bold text-slate-700 group-hover:text-blue-600">Sidebar</span>
                            <span class="text-[10px] text-slate-400">Bold left column</span>
                             <div class="absolute top-3 right-3 opacity-0 group-[.active]:opacity-100 text-blue-600">
                                <i class="fa-solid fa-circle-check"></i>
                            </div>
                        </button>

                        <!-- Wide (NEW) -->
                        <button onclick="setTemplate('wide')" class="template-btn group relative p-4 border-2 rounded-xl text-left hover:border-blue-500 transition-all bg-white shadow-sm" data-template="wide">
                            <div class="w-full h-12 bg-slate-50 rounded mb-3 border border-slate-100 overflow-hidden flex items-center justify-between p-2 gap-2 opacity-60 group-hover:opacity-100 transition-opacity">
                                <div class="w-5 h-5 rounded-full bg-slate-300"></div>
                                <div class="h-3 w-px bg-slate-200"></div>
                                <div class="flex-1 space-y-1">
                                    <div class="h-1 w-full bg-slate-300 rounded"></div>
                                    <div class="h-1 w-2/3 bg-slate-200 rounded"></div>
                                </div>
                            </div>
                            <span class="block text-sm font-bold text-slate-700 group-hover:text-blue-600">Wide</span>
                            <span class="text-[10px] text-slate-400">3-Column layout</span>
                             <div class="absolute top-3 right-3 opacity-0 group-[.active]:opacity-100 text-blue-600">
                                <i class="fa-solid fa-circle-check"></i>
                            </div>
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="h-12"></div>
        </div>

        <!-- NEW SIDEBAR FOOTER -->
        <div class="p-4 border-t border-slate-100 bg-slate-50 text-center sticky bottom-0 z-20">
            <p class="text-xs text-slate-500 font-medium">Made with ❤️ by Javed Ali</p>
        </div>
    </div>

    <!-- RIGHT SIDE: Preview Area -->
    <div class="flex-1 flex flex-col h-full preview-bg relative overflow-hidden z-0">
        
        <!-- Top Bar -->
        <div class="h-16 border-b border-slate-200/60 bg-white/50 backdrop-blur-sm flex items-center justify-end px-8 gap-4">
             <button onclick="copyToClipboard()" id="copyBtn" class="group flex items-center gap-2 bg-slate-900 hover:bg-slate-800 text-white px-5 py-2.5 rounded-xl font-semibold shadow-lg shadow-slate-900/10 transition-all transform active:scale-95 text-sm">
                <i class="fa-regular fa-copy group-hover:animate-pulse"></i>
                <span>Copy Signature</span>
            </button>
        </div>

        <!-- Canvas -->
        <div class="flex-1 flex items-center justify-center p-6 md:p-12 overflow-auto">
            
            <!-- Email Window Simulation -->
            <div class="w-full max-w-4xl bg-white rounded-2xl shadow-2xl border border-slate-200/80 overflow-hidden ring-1 ring-slate-900/5">
                <!-- Mac-style Window Header -->
                <div class="bg-slate-50 border-b border-slate-100 px-4 py-3 flex items-center gap-4">
                    <div class="flex gap-2">
                        <div class="w-3 h-3 rounded-full bg-rose-400/80"></div>
                        <div class="w-3 h-3 rounded-full bg-amber-400/80"></div>
                        <div class="w-3 h-3 rounded-full bg-emerald-400/80"></div>
                    </div>
                    <div class="flex-1 text-center">
                        <span class="text-xs font-medium text-slate-400">New Message</span>
                    </div>
                    <div class="w-14"></div> <!-- Spacer for center balance -->
                </div>

                <!-- Email Headers -->
                <div class="px-6 py-4 border-b border-slate-50 space-y-3">
                     <div class="flex items-center gap-3">
                        <span class="text-xs font-semibold text-slate-400 w-12 text-right">To:</span>
                        <div class="px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded-md font-medium">Design Team</div>
                    </div>
                    <div class="flex items-center gap-3">
                        <span class="text-xs font-semibold text-slate-400 w-12 text-right">Subject:</span>
                        <span class="text-sm font-semibold text-slate-700">Re: Design System Update - v2.0 Launch</span>
                    </div>
                </div>
                
                <!-- Email Body -->
                <div class="p-8 min-h-[400px] flex flex-col bg-white">
                    <div class="space-y-4 mb-12 text-slate-600 text-sm leading-relaxed max-w-2xl font-light">
                        <p>Hi Team,</p>
                        <p>Just wanted to share the latest updates for the new design system. We've updated the component library and the documentation is now live.</p>
                        <p>Let me know if you have any feedback before the weekly sync.</p>
                        <p>Best regards,</p>
                    </div>

                    <!-- THE SIGNATURE RENDER TARGET -->
                    <!-- Added outline-none and specific padding to ensure clean copy -->
                    <div id="signature-preview-container" class="mt-auto border-t border-dashed border-slate-100 pt-6">
                        <!-- Signature injected here via JS -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Toast Notification -->
        <div id="toast" class="absolute bottom-10 left-1/2 transform -translate-x-1/2 bg-slate-800 text-white px-6 py-3.5 rounded-full shadow-2xl flex items-center gap-3 transition-all duration-300 opacity-0 translate-y-10 pointer-events-none z-50">
            <div class="w-5 h-5 bg-emerald-500 rounded-full flex items-center justify-center">
                <i class="fa-solid fa-check text-[10px] text-white"></i>
            </div>
            <span id="toast-message" class="text-sm font-medium">Copied to clipboard!</span>
        </div>
    </div>

    <!-- JAVASCRIPT LOGIC -->
    <script>
        // --- STATE MANAGEMENT ---
        const state = {
            template: 'classic',
            details: {
                firstName: '', lastName: '', jobTitle: '', department: '',
                companyName: '', website: '',
                mobilePhone: '', officePhone: '', email: '', address: ''
            },
            social: {
                linkedin: '', twitter: '', instagram: '', facebook: '', whatsapp: '', youtube: '', tiktok: '', bluesky: '', github: '', scholar: ''
            },
            design: {
                photoUrl: '', logoUrl: '', themeColor: '#2563EB', font: 'jakarta', imageShape: 'circle', imageSize: 100
            }
        };

        // --- DOM ELEMENTS ---
        const inputs = document.querySelectorAll('input:not([type="file"])');
        const previewContainer = document.getElementById('signature-preview-container');
        const themeColorInput = document.getElementById('themeColor');
        const colorValueLabel = document.getElementById('colorValue');
        const imageSizeLabel = document.getElementById('imageSizeLabel');

        // --- FONT OPTIONS CONFIGURATION ---
        const fontOptions = {
            // Modern Sans (Google Fonts)
            "jakarta": { name: "Plus Jakarta Sans (Default)", family: "'Plus Jakarta Sans', sans-serif" },
            "inter": { name: "Inter", family: "'Inter', sans-serif" },
            "roboto": { name: "Roboto", family: "'Roboto', sans-serif" },
            "openSans": { name: "Open Sans", family: "'Open Sans', sans-serif" },
            "lato": { name: "Lato", family: "'Lato', sans-serif" },
            "montserrat": { name: "Montserrat", family: "'Montserrat', sans-serif" },
            
            // Standard Sans
            "arial": { name: "Arial", family: "Arial, Helvetica, sans-serif" },
            "arialBlack": { name: "Arial Black", family: "'Arial Black', Gadget, sans-serif" },
            "verdana": { name: "Verdana", family: "Verdana, Geneva, sans-serif" },
            "tahoma": { name: "Tahoma", family: "Tahoma, Geneva, sans-serif" },
            "trebuchet": { name: "Trebuchet MS", family: "'Trebuchet MS', Helvetica, sans-serif" },
            "impact": { name: "Impact", family: "Impact, Charcoal, sans-serif" },
            "gillSans": { name: "Gill Sans", family: "'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif" },
            "segoe": { name: "Segoe UI", family: "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif" },
            
            // Serif
            "times": { name: "Times New Roman", family: "'Times New Roman', Times, serif" },
            "georgia": { name: "Georgia", family: "Georgia, serif" },
            "palatino": { name: "Palatino", family: "'Palatino Linotype', 'Book Antiqua', Palatino, serif" },
            "baskerville": { name: "Baskerville", family: "Baskerville, 'Baskerville Old Face', 'Hoefler Text', Garamond, 'Times New Roman', serif" },
            "garamond": { name: "Garamond", family: "Garamond, 'Apple Garamond', 'Baskerville', 'Times New Roman', serif" },

            // Monospace
            "courier": { name: "Courier New", family: "'Courier New', Courier, monospace" },
            "lucida": { name: "Lucida Console", family: "'Lucida Console', Monaco, monospace" },
            "monaco": { name: "Monaco", family: "Monaco, Consolas, 'Lucida Console', monospace" },
            "andale": { name: "Andale Mono", family: "'Andale Mono', monospace" },

            // Cursive / Fantasy
            "brush": { name: "Brush Script", family: "'Brush Script MT', cursive" },
            "comic": { name: "Comic Sans MS", family: "'Comic Sans MS', cursive, sans-serif" }
        };

        // --- INITIALIZATION ---
        function init() {
            // Attach listeners to all text/color inputs
            inputs.forEach(input => {
                input.addEventListener('input', handleInput);
            });
            
            // Populate Font Select Dropdown
            const fontSelect = document.getElementById('fontSelect');
            Object.keys(fontOptions).forEach(key => {
                const option = document.createElement('option');
                option.value = key;
                option.text = fontOptions[key].name;
                fontSelect.appendChild(option);
            });
            
            // Set initial value for select
            fontSelect.value = state.design.font;

            // Initial render
            updateStateFromDOM();
            renderSignature();
            updateTemplateUI('classic'); // Set initial UI state
            updateShapeUI('circle');
        }

        function handleInput(e) {
            updateStateFromDOM();
            if (e.target.id === 'themeColor') {
                colorValueLabel.textContent = e.target.value.toUpperCase();
                state.design.themeColor = e.target.value;
            }
            if (e.target.id === 'imageSize') {
                imageSizeLabel.textContent = e.target.value + 'px';
            }
            renderSignature();
        }
        
        // Handle File Upload for Profile Photo
        function handleImageUpload(input) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    // Update the text input with the base64 data (for visual consistency)
                    // and update state
                    const base64 = e.target.result;
                    document.getElementById('photoUrl').value = base64;
                    state.design.photoUrl = base64;
                    renderSignature();
                }
                reader.readAsDataURL(input.files[0]);
            }
        }

        function updateStateFromDOM() {
            // Helper to get value
            const getVal = (id) => document.getElementById(id)?.value || '';

            state.details.firstName = getVal('firstName');
            state.details.lastName = getVal('lastName');
            state.details.jobTitle = getVal('jobTitle');
            state.details.department = getVal('department');
            state.details.companyName = getVal('companyName');
            state.details.website = getVal('website');
            state.details.mobilePhone = getVal('mobilePhone');
            state.details.officePhone = getVal('officePhone');
            state.details.email = getVal('email');
            state.details.address = getVal('address');

            state.social.linkedin = getVal('linkedin');
            state.social.twitter = getVal('twitter');
            state.social.instagram = getVal('instagram');
            state.social.facebook = getVal('facebook');
            state.social.whatsapp = getVal('whatsapp');
            state.social.youtube = getVal('youtube');
            state.social.tiktok = getVal('tiktok');
            state.social.bluesky = getVal('bluesky');
            state.social.github = getVal('github');
            state.social.scholar = getVal('scholar');

            state.design.photoUrl = getVal('photoUrl');
            state.design.logoUrl = getVal('logoUrl');
            state.design.themeColor = document.getElementById('themeColor').value;
            state.design.imageSize = document.getElementById('imageSize').value;
        }

        function switchTab(tabName) {
            // Update Tab Buttons (Segmented Control Style)
            document.querySelectorAll('button[id^="tab-btn-"]').forEach(btn => {
                if(btn.id === `tab-btn-${tabName}`) {
                    btn.classList.remove('text-slate-500', 'bg-transparent');
                    btn.classList.add('bg-white', 'text-slate-800', 'shadow-sm');
                } else {
                    btn.classList.add('text-slate-500', 'bg-transparent');
                    btn.classList.remove('bg-white', 'text-slate-800', 'shadow-sm');
                }
            });

            // Update Tab Content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(`tab-${tabName}`).classList.add('active');
        }

        function setThemeColor(color) {
            themeColorInput.value = color;
            colorValueLabel.textContent = color.toUpperCase();
            // Trigger input event manually to update state
            themeColorInput.dispatchEvent(new Event('input'));
        }

        function setFont(fontName) {
            state.design.font = fontName;
            renderSignature();
        }

        function setTemplate(templateName) {
            state.template = templateName;
            updateTemplateUI(templateName);
            renderSignature();
        }
        
        function setImageShape(shape) {
            state.design.imageShape = shape;
            updateShapeUI(shape);
            renderSignature();
        }

        function updateTemplateUI(activeTemplate) {
            document.querySelectorAll('.template-btn').forEach(btn => {
                if(btn.dataset.template === activeTemplate) {
                    btn.classList.add('active', 'border-blue-500', 'bg-blue-50/30', 'ring-1', 'ring-blue-500');
                    btn.classList.remove('border-slate-200');
                } else {
                    btn.classList.remove('active', 'border-blue-500', 'bg-blue-50/30', 'ring-1', 'ring-blue-500');
                    btn.classList.add('border-slate-200');
                }
            });
        }
        
        function updateShapeUI(activeShape) {
            document.querySelectorAll('.shape-btn').forEach(btn => {
                if(btn.dataset.shape === activeShape) {
                    btn.classList.add('active', 'bg-slate-100', 'text-blue-600', 'border-blue-500');
                    btn.classList.remove('text-slate-600', 'border-slate-200');
                } else {
                    btn.classList.remove('active', 'bg-slate-100', 'text-blue-600', 'border-blue-500');
                    btn.classList.add('text-slate-600', 'border-slate-200');
                }
            });
        }

        // --- RENDER LOGIC ---
        function renderSignature() {
            const d = state.details;
            const s = state.social;
            const deg = state.design;
            const color = deg.themeColor;

            // Resolve Font Stack
            const fontStack = fontOptions[deg.font] ? fontOptions[deg.font].family : fontOptions.jakarta.family;
            
            // Resolve Image Radius
            const imgRadius = deg.imageShape === 'circle' ? '50%' : '8px';
            
            // Resolve Image Size
            const imgSize = deg.imageSize + 'px';

            // --- ICONS CONFIGURATION (PNGs for Email Compatibility) ---
            const icons = {
                phone: 'https://cdn-icons-png.flaticon.com/512/159/159832.png',
                email: 'https://cdn-icons-png.flaticon.com/512/542/542638.png',
                web: 'https://cdn-icons-png.flaticon.com/512/1006/1006771.png',
                location: 'https://cdn-icons-png.flaticon.com/512/535/535239.png',
                
                linkedin: 'https://cdn-icons-png.flaticon.com/512/174/174857.png',
                twitter: 'https://cdn-icons-png.flaticon.com/512/12107/12107562.png', // Square X logo
                instagram: 'https://cdn-icons-png.flaticon.com/512/174/174855.png',
                facebook: 'https://cdn-icons-png.flaticon.com/512/733/733547.png',
                whatsapp: 'https://cdn-icons-png.flaticon.com/512/733/733585.png',
                youtube: 'https://cdn-icons-png.flaticon.com/512/1384/1384060.png',
                tiktok: 'https://cdn-icons-png.flaticon.com/512/3046/3046121.png',
                bluesky: 'https://upload.wikimedia.org/wikipedia/commons/thumb/7/7a/Bluesky_Logo.svg/100px-Bluesky_Logo.svg.png',
                github: 'https://cdn-icons-png.flaticon.com/512/25/25231.png',
                scholar: 'https://cdn-icons-png.flaticon.com/512/2991/2991148.png'
            };

            // Generate Social Icons HTML (NO BACKGROUND BOXES, Just Icons)
            let socialHtml = '';
            // Style: Icon only, some spacing
            const socialStyle = `text-decoration: none; display: inline-block; width: 20px; height: 20px; margin-right: 8px; vertical-align: middle;`;
            
            if (s.linkedin) socialHtml += `<a href="${ensureHttp(s.linkedin)}" style="${socialStyle}"><img src="${icons.linkedin}" width="20" height="20" style="display:block;" alt="LI"/></a>`;
            if (s.twitter) socialHtml += `<a href="${ensureHttp(s.twitter)}" style="${socialStyle}"><img src="${icons.twitter}" width="20" height="20" style="display:block;" alt="X"/></a>`;
            if (s.instagram) socialHtml += `<a href="${ensureHttp(s.instagram)}" style="${socialStyle}"><img src="${icons.instagram}" width="20" height="20" style="display:block;" alt="IG"/></a>`;
            if (s.facebook) socialHtml += `<a href="${ensureHttp(s.facebook)}" style="${socialStyle}"><img src="${icons.facebook}" width="20" height="20" style="display:block;" alt="FB"/></a>`;
            if (s.whatsapp) socialHtml += `<a href="${ensureHttp(s.whatsapp)}" style="${socialStyle}"><img src="${icons.whatsapp}" width="20" height="20" style="display:block;" alt="WA"/></a>`;
            if (s.youtube) socialHtml += `<a href="${ensureHttp(s.youtube)}" style="${socialStyle}"><img src="${icons.youtube}" width="20" height="20" style="display:block;" alt="YT"/></a>`;
            if (s.tiktok) socialHtml += `<a href="${ensureHttp(s.tiktok)}" style="${socialStyle}"><img src="${icons.tiktok}" width="20" height="20" style="display:block;" alt="TT"/></a>`;
            if (s.bluesky) socialHtml += `<a href="${ensureHttp(s.bluesky)}" style="${socialStyle}"><img src="${icons.bluesky}" width="20" height="20" style="display:block;" alt="BS"/></a>`;
            if (s.github) socialHtml += `<a href="${ensureHttp(s.github)}" style="${socialStyle}"><img src="${icons.github}" width="20" height="20" style="display:block;" alt="GH"/></a>`;
            if (s.scholar) socialHtml += `<a href="${ensureHttp(s.scholar)}" style="${socialStyle}"><img src="${icons.scholar}" width="20" height="20" style="display:block;" alt="GS"/></a>`;

            // Contact Lines (With Icons)
            const contactStyle = `font-family: Arial, sans-serif; font-size: 13px; color: #4b5563; line-height: 1.6; text-decoration: none; display: inline-block; vertical-align: middle;`;
            const iconWrapStyle = `display: inline-block; width: 14px; margin-right: 6px; vertical-align: -2px;`;
            
            let contactHtml = '';
            
            if (d.mobilePhone) contactHtml += `<div style="margin-bottom: 3px;"><span style="${iconWrapStyle}"><img src="${icons.phone}" width="12" style="display:block" alt="M"></span> <a href="tel:${d.mobilePhone}" style="${contactStyle}">${d.mobilePhone}</a></div>`;
            if (d.officePhone) contactHtml += `<div style="margin-bottom: 3px;"><span style="${iconWrapStyle}"><img src="${icons.phone}" width="12" style="display:block" alt="O"></span> <a href="tel:${d.officePhone}" style="${contactStyle}">${d.officePhone}</a></div>`;
            if (d.email) contactHtml += `<div style="margin-bottom: 3px;"><span style="${iconWrapStyle}"><img src="${icons.email}" width="12" style="display:block" alt="E"></span> <a href="mailto:${d.email}" style="${contactStyle}">${d.email}</a></div>`;
            if (d.website) contactHtml += `<div style="margin-bottom: 3px;"><span style="${iconWrapStyle}"><img src="${icons.web}" width="12" style="display:block" alt="W"></span> <a href="${ensureHttp(d.website)}" style="${contactStyle}">${d.website}</a></div>`;
            if (d.address) contactHtml += `<div style="margin-top: 6px;"><span style="${iconWrapStyle}"><img src="${icons.location}" width="12" style="display:block" alt="L"></span> <span style="${contactStyle}">${d.address}</span></div>`;


            // --- TEMPLATES ---
            let html = '';

            // Note: Job Title color is #4b5563 (dark gray) as requested in v1.3

            if (state.template === 'classic') {
                // CLASSIC
                html = `
                <table cellpadding="0" cellspacing="0" border="0" style="font-family: ${fontStack}; font-size: 14px; line-height: 1.4;">
                    <tr>
                        <td style="vertical-align: top; padding-right: 24px;">
                            ${deg.photoUrl ? `<img src="${deg.photoUrl}" alt="${d.firstName}" style="width: ${imgSize}; height: ${imgSize}; object-fit: cover; border-radius: ${imgRadius}; display: block;">` : ''}
                        </td>
                        <td style="vertical-align: top; border-left: 2px solid ${color}; padding-left: 24px;">
                            <div style="font-weight: bold; color: #111827; font-size: 18px; margin-bottom: 2px;">${d.firstName} ${d.lastName}</div>
                            <div style="color: #4b5563; font-size: 14px; margin-bottom: 2px;">${d.jobTitle}</div>
                            ${d.department ? `<div style="color: #4b5563; font-size: 14px; margin-bottom: 4px;">${d.department}</div>` : ''}
                            <div style="color: #6b7280; font-size: 13px; font-weight: bold; margin-bottom: 16px;">${d.companyName}</div>
                            
                            ${contactHtml}
                            
                            <div style="margin-top: 16px;">
                                ${socialHtml}
                            </div>
                        </td>
                    </tr>
                    ${deg.logoUrl ? `<tr><td colspan="2" style="padding-top: 20px;"><img src="${deg.logoUrl}" style="height: 35px; display: block;" alt="Logo" /></td></tr>` : ''}
                </table>
                `;
            } else if (state.template === 'compact') {
                // COMPACT
                html = `
                <table cellpadding="0" cellspacing="0" border="0" style="font-family: ${fontStack}; font-size: 13px;">
                    <tr>
                        <td style="vertical-align: middle; padding-right: 15px;">
                             ${deg.photoUrl ? `<img src="${deg.photoUrl}" alt="${d.firstName}" style="width: ${imgSize}; height: ${imgSize}; object-fit: cover; border-radius: ${imgRadius}; display: block;">` : ''}
                        </td>
                        <td>
                            <div style="font-weight: 800; color: #000; font-size: 15px;">${d.firstName} ${d.lastName}</div>
                            <div style="color: #555; font-size: 13px; margin-bottom: 5px;">${d.jobTitle} at <span style="font-weight: bold; color:${color}">${d.companyName}</span></div>
                            <div style="font-size: 12px; color: #777;">
                                <a href="mailto:${d.email}" style="color: #777; text-decoration: none;">${d.email}</a> • 
                                <a href="${ensureHttp(d.website)}" style="color: #777; text-decoration: none;">${d.website}</a>
                            </div>
                            <div style="margin-top: 8px;">
                                ${socialHtml}
                            </div>
                        </td>
                    </tr>
                </table>
                `;
            } else if (state.template === 'stacked') {
                // STACKED
                html = `
                <table cellpadding="0" cellspacing="0" border="0" width="100%" style="font-family: ${fontStack}; font-size: 14px; text-align: center; max-width: 400px;">
                    <tr>
                        <td align="center" style="padding-bottom: 15px;">
                             ${deg.photoUrl ? `<img src="${deg.photoUrl}" alt="${d.firstName}" style="width: ${imgSize}; height: ${imgSize}; object-fit: cover; border-radius: ${imgRadius}; border: 3px solid ${color};">` : ''}
                        </td>
                    </tr>
                    <tr>
                        <td align="center" style="font-weight: bold; font-size: 18px; color: #333;">${d.firstName} ${d.lastName}</td>
                    </tr>
                    <tr>
                        <td align="center" style="color: #555; font-size: 14px; padding-bottom: 10px; text-transform: uppercase; letter-spacing: 1px;">${d.jobTitle}</td>
                    </tr>
                    <tr>
                         <td align="center" style="border-top: 1px solid #ddd; padding-top: 10px; font-size: 12px; color: #555; line-height: 1.6;">
                            <img src="${icons.email}" width="10" /> ${d.email} <br>
                            <img src="${icons.phone}" width="10" /> ${d.mobilePhone} | <img src="${icons.web}" width="10" /> ${d.website}
                         </td>
                    </tr>
                    <tr>
                        <td align="center" style="padding-top: 15px;">
                            ${socialHtml}
                        </td>
                    </tr>
                </table>
                `;
            } else if (state.template === 'banner') {
                 // BANNER
                html = `
                <table cellpadding="0" cellspacing="0" border="0" style="font-family: ${fontStack}; font-size: 14px; min-width: 350px;">
                    <tr>
                        <td style="padding-bottom: 8px;">
                            <span style="font-weight: bold; font-size: 16px; color: #000;">${d.firstName} ${d.lastName}</span>
                            <span style="color: #888; padding: 0 5px;">/</span>
                            <span style="color: #555;">${d.jobTitle}</span>
                        </td>
                    </tr>
                    <tr>
                         <td style="padding-bottom: 12px; font-size: 13px; color: #555;">
                             ${d.companyName}
                         </td>
                    </tr>
                    <tr>
                        <td style="background-color: ${color}; padding: 10px 15px; border-radius: 4px; color: #ffffff;">
                             <table cellpadding="0" cellspacing="0" border="0" width="100%">
                                <tr>
                                    <td style="color: #ffffff; font-size: 12px;">
                                        <img src="${icons.email}" width="10" style="filter: brightness(0) invert(1);" /> <a href="mailto:${d.email}" style="color: #ffffff; text-decoration: none; font-weight: bold; margin-right: 15px;">Email Me</a>
                                        <img src="${icons.web}" width="10" style="filter: brightness(0) invert(1);" /> <a href="${ensureHttp(d.website)}" style="color: #ffffff; text-decoration: none; font-weight: bold;">Visit Website</a>
                                    </td>
                                    <td align="right">
                                         ${s.linkedin ? `<a href="${ensureHttp(s.linkedin)}" style="text-decoration:none; margin-left:5px;"><img src="${icons.linkedin}" width="14" style="filter: brightness(0) invert(1);"/></a>` : ''}
                                         ${s.twitter ? `<a href="${ensureHttp(s.twitter)}" style="text-decoration:none; margin-left:5px;"><img src="${icons.twitter}" width="14" style="filter: brightness(0) invert(1);"/></a>` : ''}
                                    </td>
                                </tr>
                             </table>
                        </td>
                    </tr>
                </table>
                `;
            } else if (state.template === 'sidebar') {
                // SIDEBAR (New)
                html = `
                <table cellpadding="0" cellspacing="0" border="0" style="font-family: ${fontStack}; font-size: 14px; line-height: 1.4; border-collapse: separate; border-spacing: 0;">
                    <tr>
                        <td style="background-color: ${color}; padding: 25px 20px; width: 140px; vertical-align: middle; text-align: center; border-radius: 6px 0 0 6px;">
                            ${deg.photoUrl ? `<img src="${deg.photoUrl}" style="width: ${imgSize}; height: ${imgSize}; border-radius: ${imgRadius}; border: 3px solid #ffffff; margin-bottom: 15px; display:inline-block; object-fit: cover;">` : ''}
                             <div style="color: #ffffff; font-weight: bold; font-size: 16px; line-height: 1.2;">${d.firstName}<br>${d.lastName}</div>
                             ${deg.logoUrl ? `<div style="margin-top: 15px; padding-top:15px; border-top: 1px solid rgba(255,255,255,0.2);"><img src="${deg.logoUrl}" style="max-width: 80px; max-height: 30px; filter: brightness(0) invert(1);" alt="Logo" /></div>` : ''}
                        </td>
                        <td style="background-color: #ffffff; padding: 25px; vertical-align: top; border: 1px solid #e5e7eb; border-left: none; border-radius: 0 6px 6px 0;">
                            <div style="color: ${color}; font-weight: bold; font-size: 14px; margin-bottom: 2px;">${d.jobTitle}</div>
                            ${d.department ? `<div style="color: #6b7280; font-size: 12px; margin-bottom: 6px;">${d.department}</div>` : ''}
                            <div style="color: #374151; font-weight: bold; font-size: 13px; margin-bottom: 15px;">${d.companyName}</div>
                            
                            ${contactHtml}
                            
                            <div style="margin-top: 20px; padding-top: 15px; border-top: 1px dashed #e5e7eb;">
                                ${socialHtml}
                            </div>
                        </td>
                    </tr>
                </table>
                `;
            } else if (state.template === 'wide') {
                // WIDE (New)
                html = `
                <table cellpadding="0" cellspacing="0" border="0" width="100%" style="font-family: ${fontStack}; font-size: 14px; border-top: 3px solid ${color}; padding-top: 20px;">
                    <tr>
                        <td style="padding-right: 25px; vertical-align: top; width: 1px;">
                             ${deg.photoUrl ? `<img src="${deg.photoUrl}" style="width: ${imgSize}; height: ${imgSize}; border-radius: ${imgRadius}; object-fit: cover;">` : ''}
                        </td>
                        <td style="vertical-align: top; padding-right: 25px; border-right: 1px solid #e5e7eb;">
                             <div style="font-weight: 800; color: #111827; font-size: 20px; margin-bottom: 4px;">${d.firstName} ${d.lastName}</div>
                             <div style="color: ${color}; font-weight: 600; font-size: 14px;">${d.jobTitle}</div>
                             ${d.department ? `<div style="color: #6b7280; font-size: 13px; margin-bottom: 10px;">${d.department}</div>` : ''}
                             <div style="color: #374151; font-size: 14px; margin-top: 8px;">${d.companyName}</div>
                             ${deg.logoUrl ? `<div style="margin-top: 12px;"><img src="${deg.logoUrl}" style="height: 25px;" alt="Logo" /></div>` : ''}
                        </td>
                        <td style="vertical-align: top; padding-left: 25px;">
                             <div style="margin-bottom: 15px;">${contactHtml}</div>
                             <div>${socialHtml}</div>
                        </td>
                    </tr>
                </table>
                `;
            }

            previewContainer.innerHTML = html;
        }

        // --- UTILS ---
        function ensureHttp(url) {
            if (!url) return '';
            if (!/^https?:\/\//i.test(url)) {
                return 'https://' + url;
            }
            return url;
        }

        async function copyToClipboard() {
            const range = document.createRange();
            range.selectNode(previewContainer);
            window.getSelection().removeAllRanges();
            window.getSelection().addRange(range);
            
            try {
                // Modern way
                document.execCommand('copy');
                showToast('Signature copied! Paste it into your email settings.');
            } catch (err) {
                showToast('Failed to copy. Please manually select and copy.');
            }
            
            window.getSelection().removeAllRanges();
        }

        function showToast(msg) {
            const toast = document.getElementById('toast');
            const msgSpan = document.getElementById('toast-message');
            msgSpan.innerText = msg;
            
            toast.classList.remove('opacity-0', 'translate-y-10', 'pointer-events-none');
            
            setTimeout(() => {
                toast.classList.add('opacity-0', 'translate-y-10', 'pointer-events-none');
            }, 3000);
        }

        // Start
        init();

    </script>
</body>
</html>
